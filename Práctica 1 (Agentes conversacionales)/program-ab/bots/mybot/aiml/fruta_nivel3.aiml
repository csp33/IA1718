<?xml version="1.0"
encoding="UTF-8"?>
<aiml version="2.0">

<!-- TEST: -->
<category>
	<pattern>test3</pattern>
	<template>
		Piensa en la MANZANA.<srai>primera_pregunta</srai>
	</template>
</category>

<!-- Descartar frutas -->
<category>
	<pattern>descartar_frutas</pattern>
	<template>
		<think>
			<condition name="tamanio_adivinado">
				<li value="SI">
					<set name="posibles"><map name="segun_tamanio"><get name="tamanio"/></map></set>
				</li>
			</condition>
			<condition name="color_adivinado">
				<li value="SI">
					<set var="lista_tamanios"><get name="posibles"/></set>
					<set var="tam_copia"><get name="posibles"/></set>
					<set var="lista_colores"><map name="segun_color"><get name="color"/></map></set>
					<set name="posibles">0</set>
					<set var="contador">0</set>
					<set var="tope"><srai>COUNT <get var="lista_tamanios"/></srai></set>
					<condition var="contador">
						<li><value><get var="tope"/></value></li>
						<li>
							<set var="top"><srai> TOP <get var="lista_tamanios"/></srai></set>
							<set var="lista_tamanios"><srai>REMAIN <get var="lista_tamanios"/></srai></set>
							<set var="existe"><srai>FINDITEM <get var="top"/> IN <get var="lista_colores"/></srai></set>
							<condition var="existe">
								<li value="0">
								</li>
								<li> <!-- Existe-->
							<condition name="posibles">
										<li value="0">
											<set name="posibles"><get var="top"/></set>
										</li>
										<li>
											<srai> ADDITEM <get var="top"/> IN <get name="posibles"/></srai>
										</li>
									</condition>
								</li>
							</condition>
							<set var="contador"><map name="successor"><get var="contador"/></map></set>
							<loop/>
						</li>
						</condition>
				</li>
			</condition>
			<condition name="sabor_adivinado">
				<li value="SI">
					<set var="lista_tamanios_colores"><get name="posibles"/></set>
					<set var="lista_tamanios_colores_copia"><get name="posibles"/></set>
					<set var="lista_sabores"><map name="segun_sabor"><get name="sabor"/></map></set>
					<set name="posibles">0</set>
					<set var="contador">0</set>
					<set var="tope"><srai>COUNT <get var="lista_tamanios_colores"/></srai></set>
					<condition var="contador">
						<li><value><get var="tope"/></value></li>
						<li>
							<set var="top"><srai> TOP <get var="lista_tamanios_colores"/></srai></set>
							<set var="lista_tamanios_colores"><srai>REMAIN <get var="lista_tamanios_colores"/></srai></set>
							<set var="existe"><srai>FINDITEM <get var="top"/> IN <get var="lista_sabores"/></srai></set>
							<condition var="existe">
								<li value="0">
								</li>
								<li> <!-- Existe-->
									<condition name="posibles">
										<li value="0">
											<set name="posibles"><get var="top"/></set>
										</li>
										<li>
											<srai> ADDITEM <get var="top"/> IN <get name="posibles"/></srai>
										</li>
									</condition>
								</li>
							</condition>
							<set var="contador"><map name="successor"><get var="contador"/></map></set>
							<loop/>
						</li>
						</condition>
				</li>
			</condition>
			<condition name="vit_a">
				<li value="SI">
					<set var="lista_tamanios_colores_sabores"><get name="posibles"/></set>
					<set var="lista_tamanios_colores_sabores_copia"><get name="posibles"/></set>
					<set var="lista_vit_a"><readset>vitamina_a</readset></set>
					<set name="posibles">0</set>
					<set var="contador">0</set>
					<set var="tope"><srai>COUNT <get var="lista_tamanios_colores_sabores"/></srai></set>
					<condition var="contador">
						<li><value><get var="tope"/></value></li>
						<li>
							<set var="top"><srai> TOP <get var="lista_tamanios_colores_sabores"/></srai></set>
							<set var="lista_tamanios_colores_sabores"><srai>REMAIN <get var="lista_tamanios_colores_sabores"/></srai></set>
							<set var="existe"><srai>FINDITEM <get var="top"/> IN <get var="lista_vit_a"/></srai></set>
							<condition var="existe">
								<li value="0">
								</li>
								<li> <!-- Existe-->
									<condition name="posibles">
										<li value="0">
											<set name="posibles"><get var="top"/></set>
										</li>
										<li>
											<srai> ADDITEM <get var="top"/> IN <get name="posibles"/></srai>
										</li>
									</condition>
								</li>
							</condition>
							<set var="contador"><map name="successor"><get var="contador"/></map></set>
							<loop/>
						</li>
					</condition>
				</li>	
			</condition>	
			<condition name="vit_b">
				<li value="SI">
					<set var="lista_tamanios_colores_sabores_vit_a"><get name="posibles"/></set>
					<set var="lista_tamanios_colores_sabores_vit_a_copia"><get name="posibles"/></set>
					<set var="lista_vit_a"><readset>vitamina_b</readset></set>
					<set name="posibles">0</set>
					<set var="contador">0</set>
					<set var="tope"><srai>COUNT <get var="lista_tamanios_colores_sabores_vit_a"/></srai></set>
					<condition var="contador">
						<li><value><get var="tope"/></value></li>
						<li>
							<set var="top"><srai> TOP <get var="lista_tamanios_colores_sabores_vit_a"/></srai></set>
							<set var="lista_tamanios_colores_sabores_vit_a"><srai>REMAIN <get var="lista_tamanios_colores_sabores_vit_a"/></srai></set>
							<set var="existe"><srai>FINDITEM <get var="top"/> IN <get var="lista_vit_a"/></srai></set>
							<condition var="existe">
								<li value="0">
								</li>
								<li> <!-- Existe-->
									<condition name="posibles">
										<li value="0">
											<set name="posibles"><get var="top"/></set>
										</li>
										<li>
											<srai> ADDITEM <get var="top"/> IN <get name="posibles"/></srai>
										</li>
									</condition>
								</li>
							</condition>
							<set var="contador"><map name="successor"><get var="contador"/></map></set>
							<loop/>
						</li>
					</condition>
				</li>	
			</condition>	
			<condition name="vit_c">
				<li value="SI">
					<set var="lista_tamanios_colores_sabores_vit_a_vit_b"><get name="posibles"/></set>
					<set var="lista_tamanios_colores_sabores_vit_a_vit_b_copia"><get name="posibles"/></set>
					<set var="lista_vit_a"><readset>vitamina_c</readset></set>
					<set name="posibles">0</set>
					<set var="contador">0</set>
					<set var="tope"><srai>COUNT <get var="lista_tamanios_colores_sabores_vit_a_vit_b"/></srai></set>
					<condition var="contador">
						<li><value><get var="tope"/></value></li>
						<li>
							<set var="top"><srai> TOP <get var="lista_tamanios_colores_sabores_vit_a_vit_b"/></srai></set>
							<set var="lista_tamanios_colores_sabores_vit_a_vit_b"><srai>REMAIN <get var="lista_tamanios_colores_sabores_vit_a_vit_b"/></srai></set>
							<set var="existe"><srai>FINDITEM <get var="top"/> IN <get var="lista_vit_a"/></srai></set>
							<condition var="existe">
								<li value="0">
								</li>
								<li> <!-- Existe-->
									<condition name="posibles">
										<li value="0">
											<set name="posibles"><get var="top"/></set>
										</li>
										<li>
											<srai> ADDITEM <get var="top"/> IN <get name="posibles"/></srai>
										</li>
									</condition>
								</li>
							</condition>
							<set var="contador"><map name="successor"><get var="contador"/></map></set>
							<loop/>
						</li>
					</condition>
				</li>	
			</condition>			
			<set name="restantes"><srai>COUNT <get name="posibles"/></srai></set>
		</think> 
		<condition name="restantes">
			<li value="1">
				<srai>adivinar</srai>
			</li>
		</condition>
	</template>
</category>

<category>
	<pattern>adivinar</pattern>
	<template>
		Ya lo se tu fruta es <srai>TOP <get name="posibles"/></srai>
	</template>
</category>

<category>
	<pattern>^ [no error fallaste] ^ es *</pattern>
	<that>Ya lo se tu fruta es *</that>
	<template>
		<think>
			<set var="lista_frutas"><readset>frutas</readset></set>
			<set var="existe"><srai>FINDITEM <star index="3"/> IN <get var="lista_frutas"/></srai></set>
			</think>
			<condition var="existe">
				<li value="0">
					Yo no conozco esa fruta!! 
				</li>
				<li>
					<srai>detectar_trampa <star index="3"/></srai>
				</li>
			</condition>
	</template>
</category>

<category>
	<pattern>detectar_trampa *</pattern>
	<template>
		<think>
			<set var="fruta_trampa"><star index="1"/></set>
			<set var="color_trampa"><map name="color_varios"><get var="fruta_trampa"/></map></set>
			<set var="tamanio_trampa"><map name="tamanio"><get var="fruta_trampa"/></map></set>
			<set var="color_trampa"><map name="color"><get var="fruta_trampa"/></map></set>
			<set var="vit_a_trampa"><map name="vit_a"><get var="fruta_trampa"/></map></set>
			<set var="vit_b_trampa"><map name="vit_b"><get var="fruta_trampa"/></map></set>
			<set var="vit_c_trampa"><map name="vit_c"><get var="fruta_trampa"/></map></set>
		</think>
		fruta_trampa vale <get var="fruta_trampa"/>
		color_trampa vale <get var="color_trampa"/>
		<condition name="color">
			<li><value><get var="color_trampa"/></value></li>
			<li>
				Me mentiste! Dijiste que era de color <get var="color"/> y es de color <get name="color_trampa"/>
			</li>
		</condition>
		<condition name="tamanio">
			<li><value><get var="tamanio_trampa"/></value></li>
			<li>
				Me mentiste! Dijiste que era de tamanio <get var="tamanio"/> y es de tamanio <get name="tamanio_trampa"/>.
			</li>
		</condition>
		<condition name="sabor">
			<li><value><get var="sabor_trampa"/></value></li>
			<li>
				Me mentiste! Dijiste que era de sabor <get var="sabor"/> y es de sabor <get name="sabor_trampa"/>.
			</li>
		</condition>
		<condition name="vit_a">
			<li><value><get var="vit_a_trampa"/></value></li>
			<li>
				Me mentiste! Dijiste que <get name="vit_a"/> tenia Vitamina A pero en realidad <get var="vit_a_trampa"/> tiene.
			</li>
		</condition>
		<condition name="vit_b">
			<li><value><get var="vit_b_trampa"/></value></li>
			<li>
				Me mentiste! Dijiste que <get name="vit_b"/> tenia Vitamina B pero en realidad <get var="vit_b_trampa"/> tiene.
			</li>
		</condition>
		<condition name="vit_c">
			<li><value><get var="vit_c_trampa"/></value></li>
			<li>
				Me mentiste! Dijiste que <get name="vit_c"/> tenia Vitamina B pero en realidad <get var="vit_c_trampa"/> tiene.
			</li>
		</condition>
	</template>
</category>

<category>
	<pattern>^ [si correcto acertaste efectivamente] ^</pattern>
	<that>ya lo se ^</that>
	<template>
		Quieres jugar otra vez?
	</template>
</category>

<category>
	<pattern>^ [si vale venga vamos] ^</pattern>
	<that>quieres jugar ^</that>
	<template>
		<srai>iniciar nivel 3</srai>
	</template>
</category>

<category>
	<pattern>^ [no paso] ^</pattern>
	<that>quieres jugar ^</that>
	<template>
		Vale ;)
	</template>
</category>	

<!-- Iniciar juego -->
<category>
	<pattern>primera_pregunta</pattern>
	<template>
		<think>
			<set name="posibles"><readset>frutas</readset></set>
			<set name="sabores"><readset>sabores</readset></set>
			<set name="colores"><readset>colores</readset></set>
			<set name="tamanios"><readset>tamanios</readset></set>
		</think>
		<srai>pregunta_tamanio</srai>
	</template>
</category>

<category>
	<pattern> ^ [juego jugar iniciar] ^ nivel [3 tres] ^</pattern>
	<template>
		Vale! Piensa en una fruta. <srai>primera_pregunta</srai>
	</template>
</category>

<!-- Tamaños -->

<category>
	<pattern>pregunta_tamanio</pattern>
	<template>
		<think>
			<set var="a_preguntar"><srai>TOP <get name="tamanios"/></srai></set>
			<set name="tamanios"><srai>REMAIN <get name="tamanios"/></srai></set>
			<set var="numero_restantes"><srai>COUNT <get name="tamanios"/></srai></set>
		</think>
		<condition var="numero_restantes">
			<li value="0">
				<think>
					<set name="tamanio"><get var="a_preguntar"/></set>
					<set name="tamanio_adivinado">SI</set>
				</think>
				<srai>pregunta_color</srai>
			</li>
			<li>
				<srai>tamanio <get var="a_preguntar"/></srai>
			</li>
		</condition>
	</template>
</category>
-
<category>
	<pattern>tamanio *</pattern>
	<template>
		Es de tamanio <star index="1"/>?
		<think>
			<set name="tamanio"><star index="1"/></set>
		</think>
	</template>
</category>

<!-- Colores -->

<category>
	<pattern>pregunta_color</pattern>
	<template>
		<think>
			<set var="a_preguntar"><srai>TOP <get name="colores"/></srai></set>
			<set name="colores"><srai>REMAIN <get name="colores"/></srai></set>
			<set var="numero_restantes"><srai>COUNT <get name="colores"/></srai></set>
		</think>
		<condition var="numero_restantes">
			<li value="0">
				<think>
					<set name="color"><get var="a_preguntar"/></set>
					<set name="color_adivinado">SI</set>
				</think>
				<srai>pregunta_sabor</srai>
			</li>
			<li>
				<srai>color <get var="a_preguntar"/></srai>
			</li>
		</condition>
	</template>
</category>

<category>
	<pattern>color *</pattern>
	<template>
		Es de color <star index="1"/>?
		<think>
			<set name="color"><star index="1"/></set>
		</think>
	</template>
</category>

<!-- Sabores -->
<category>
	<pattern>pregunta_sabor</pattern>
	<template>
		<think>
			<set var="a_preguntar"><srai>TOP <get name="sabores"/></srai></set>
			<set name="sabores"><srai>REMAIN <get name="sabores"/></srai></set>
			<set var="numero_restantes"><srai>COUNT <get name="sabores"/></srai></set>
		</think>
		<condition var="numero_restantes">
			<li value="0">
				<think>
					<set name="sabor"><get var="a_preguntar"/></set>
					<set name="sabor_adivinado">SI</set>
				</think>
				<srai>pregunta_vitamina</srai>
			</li>
			<li>
				<srai>sabor <get var="a_preguntar"/></srai>
			</li>
		</condition>
	</template>
</category>

<category>
	<pattern>sabor *</pattern>
	<template>
		Tiene sabor <star index="1"/>?
		<think>
			<set name="sabor"><star index="1"/></set>
		</think>
	</template>
</category>

<!-- Vitaminas -->

<category>
	<pattern>vitamina_a</pattern>
	<template>
		Tiene vitamina a?
		<think>
			<set name="vit_a">SI</set>
		</think>
	</template>
</category>

<category>
	<pattern>vitamina_b</pattern>
	<template>
		Tiene vitamina b?
		<think>
			<set name="vit_b">SI</set>
		</think>
	</template>
</category>

<category>
	<pattern>vitamina_c</pattern>
	<template>
		Tiene vitamina c?
		<think>
			<set name="vit_c">SI</set>
		</think>
	</template>
</category>

<!--.....................................................-->

<!-- Respuestas tamaño -->

<category>
	<pattern>[si correcto afirmativo efectivamente]</pattern>
	<that>^ es de tamanio *</that>
	<template>
		<think>
			<set name="tamanio_adivinado">SI</set>
		</think>
		<srai>descartar_frutas</srai>
		<srai>pregunta_color</srai>	</template>
</category>

<category>
	<pattern>[no error fallaste]</pattern>
	<that>^ es de tamanio *</that>
	<template>
		<think>
			<set name="tamanio">no_decidido</set>
		</think>
		<srai>descartar_frutas</srai>
		<srai>pregunta_tamanio</srai>
	</template>
</category>


<!-- Respuestas color -->

<category>
	<pattern>[si correcto afirmativo efectivamente]</pattern>
	<that>^ es de color *</that>
	<template>
		<think>
			<set name="color_adivinado">SI</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>pregunta_sabor</srai>
			</li>
		</condition>
	</template>
</category>

<category>
	<pattern>[no error fallaste]</pattern>
	<that>^ es de color *</that>
	<template>
		<think>
			<set name="color">no_decidido</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>pregunta_color</srai>
			</li>
		</condition>	</template>
</category>

<!-- Respuestas sabor -->

<category>
	<pattern>[si correcto afirmativo efectivamente]</pattern>
	<that>^ tiene sabor *</that>
	<template>
		<think>
			<set name="sabor_adivinado">SI</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>vitamina_a</srai>
			</li>
		</condition>	
	</template>
</category>

<category>
	<pattern>[no error fallaste]</pattern>
	<that>^ tiene sabor *</that>
	<template>
		<think>
			<set name="sabor">no_decidido</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>pregunta_sabor</srai>
			</li>
		</condition>	
	</template>
</category>

<!-- Respuestas vitamina a-->

<category>
	<pattern>[si correcto afirmativo efectivamente]</pattern>
	<that>^ tiene vitamina a</that>
	<template>
		<think>
			<set name="vit_a">SI</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>vitamina_b</srai>
			</li>
		</condition>	
	</template>
</category>

<category>
	<pattern>[no error fallaste]</pattern>
	<that>^ tiene vitamina a</that>
	<template>
		<think>
			<set name="vit_a">NO</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>vitamina_b</srai>
			</li>
		</condition>	</template>
</category>

<!-- Respuestas vitamina b-->


<category>
	<pattern>[si correcto afirmativo efectivamente]</pattern>
	<that>^ tiene vitamina B</that>
	<template>
		<think>
			<set name="vit_B">SI</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>vitamina_c</srai>
			</li>
		</condition>	
	</template>
</category>

<category>
	<pattern>[no error fallaste]</pattern>
	<that>^ tiene vitamina b</that>
	<template>
		<think>
			<set name="vit_b">NO</set>
		</think>
		<srai>descartar_frutas</srai>
		<condition name="restantes">
			<li value="1">
			</li>
			<li>
				<srai>vitamina_c</srai>
			</li>
		</condition>	
	</template>
</category>

<!-- Respuestas vitamina c-->


<category>
	<pattern>[si correcto afirmativo efectivamente]</pattern>
	<that>^ tiene vitamina c</that>
	<template>
		<think>
			<set name="vit_c">SI</set>
		</think>
		<srai>adivinar</srai>
	</template>
</category>

<category>
	<pattern>[no error fallaste]</pattern>
	<that>^ tiene vitamina c</that>
	<template>
		<think>
			<set name="vit_c">NO</set>
		</think>
			<srai>adivinar</srai>
	</template>
</category>

</aiml>